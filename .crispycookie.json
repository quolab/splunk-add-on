{
    "layers": [
        {
            "name": "app-python",
            "layer_name": "20-base",
            "cookiecutter": {
                "layer": "20-base",
                "vendor": "QuoLab",
                "vendor_product": "QuoLab",
                "app_folder": "TA-quolab",
                "app_label": "QuoLab Add-on for Splunk",
                "build_tool": "GitHub_Actions",
                "author_splunkid": "kintyre",
                "author_email": "splunkbase@kintyre.co",
                "author_company": "Kintyre",
                "on_splunkbase": true,
                "splunkbase_id": 5456,
                "git_repo": "https://github.com/quolab/splunk-add-on",
                "git_branch": "main",
                "_template_version": "1.4.7",
                "_template": "git@github.com:Kintyre/cypress-cookiecutter.git/app-python"
            }
        },
        {
            "name": "custom-conf",
            "layer_name": "30-conf-quolabservers",
            "cookiecutter": {
                "layer": "30-conf-quolabservers",
                "vendor": "QuoLab",
                "vendor_product": "QuoLab",
                "app_folder": "TA-quolab",
                "app_label": "QuoLab Add-on for Splunk",
                "need_auth": true,
                "secret_name": "secret",
                "conf_name": "quolab_servers",
                "conf_type": "server",
                "rest_name": "quolab_servers",
                "conf_fields": {
                    "url": {
                        "label": "URL",
                        "type": "url",
                        "required": true,
                        "example": "https://example.server.com:1080/service",
                        "description": "The server name and port where QuoLab API requests will be sent",
                        "help": "This is the same URL used for accessing the QuoLab web user interface",
                        "display": {
                            "class": "input-xlarge"
                        },
                        "validation": {
                            "type": "regex",
                            "value": "^https?://[^\\s]+$"
                        }
                    },
                    "username": {
                        "label": "Username",
                        "type": "string",
                        "required": true,
                        "example": "jdoe",
                        "description": "Username for the QuoLab server.",
                        "help": "Username can be a regular user account name, or 'TOKEN' when using token-based authentication.",
                        "validation": {
                            "type": "regex",
                            "value": "^[\\w_.-]+$"
                        }
                    },
                    "secret": {
                        "default": "HIDDEN",
                        "label": "Password",
                        "type": "secret",
                        "display": {
                            "hidden": true
                        },
                        "required": true,
                        "description": "The password associated with the given username or a token"
                    },
                    "verify": {
                        "default": true,
                        "type": "bool",
                        "required": false,
                        "description": "Use HTTPS certificate validation",
                        "help": "The QuoLab HTTPS listener using a publicly signed certificate.  Please understand the security implications of settings this to false.  This should never be false if your QuoLab server is accessed on a public internet connection."
                    },
                    "max_batch_size": {
                        "label": "Max Batch Size",
                        "type": "int",
                        "description": "Number of catalog items to fetch per HTTP call",
                        "help": "The maximum number of results that can be fetched in a single query to the API.  If more events are requested at search time then multiple queries will be sent to the API using the supported pagination technique.",
                        "required": true,
                        "default": 500
                    },
                    "max_execution_time": {
                        "label": "Max Execution Time",
                        "type": "int",
                        "description": "The longest duration in seconds that any individual query may last.",
                        "required": true,
                        "default": 300
                    },
                    "disabled": {
                        "default": false,
                        "type": "bool",
                        "required": false,
                        "description": "Toggle configuration entry status"
                    }
                },
                "_template_version": "1.4.7",
                "_template": "git@github.com:Kintyre/cypress-cookiecutter.git/custom-conf",
                "custom_action": "full"
            }
        },
        {
            "name": "search-command",
            "layer_name": "50-spl-quolabquery",
            "cookiecutter": {
                "layer": "50-spl-quolabquery",
                "vendor": "QuoLab",
                "vendor_product": "QuoLab",
                "app_folder": "TA-quolab",
                "app_label": "QuoLab Add-on for Splunk",
                "author_email": "splunkbase@kintyre.co",
                "spl_class": "QuoLabQueryCommand",
                "spl_script": "quolab_query",
                "spl_command": "quolabquery",
                "spl_type": "Generating",
                "need_auth": "True",
                "conf_name": "quolab_servers",
                "conf_type": "server",
                "json_output": true,
                "_template_version": "1.4.7",
                "_template": "git@github.com:Kintyre/cypress-cookiecutter.git/search-command"
            }
        },
        {
            "name": "modinput-rest",
            "layer_name": "50-modinput-timeline",
            "cookiecutter":{
                "layer":                "50-modinput-timeline",
                "modinput_name":        "quolab_timeline",
                "modinput_class":       "QuoLabTimelineModularInput",
                "modinput_sourcetype":  "quolab:timeline",
                "modinput_sourcetype_int" : "quolab:modinput:timeline",
                "uses_state_tracking":  true,
                "is_metrics":           false,
                "is_json":              true,
                "auth_type":            "basic",
                "modinput_fields": {
                    "timeline": {
                        "type": "string",
                        "required": true,
                        "description": "GUID of timeline in QuoLab"
                    },
                    "backfill_range": {
                        "label": "Backfill range",
                        "type": "relative-time",
                        "default": "5d",
                        "required": false,
                        "example": ["5d", "3h", "10m"],
                        "help": "Duration of backfill on first run."
                    },
                    "batch_size": {
                        "type": "int",
                        "label": "Batch size",
                        "description": "Number of events to fetch per HTTPS call",
                        "default": 1000
                    },
                    "log_level": {
                        "default": "INFO",
                        "required": true,
                        "description": "Logging level for internal logging",
                        "validation": {
                            "type": "choices",
                            "value": ["DEBUG", "INFO", "WARN", "ERROR"]
                        }
                    }
                }
            }
        }
    ],
    "tool_info": {
        "program": "CrispyCookie",
        "version": "0.3.3"
    }
}
